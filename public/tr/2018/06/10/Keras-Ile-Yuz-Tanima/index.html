<!DOCTYPE html>
<html lang=tr>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Artık günümüzde bir çok yapay zeka sorununu python ve zengin kütüphaneleri sayesinde  kolaylıkla çözebiliyoruz. Eskiden oldukça zor ve karmaşık olan çözüm yöntemleri büyük firmaların kullandıkları yap">
<meta name="keywords" content="deep learning,keras,yapay zeka,CNN">
<meta property="og:type" content="article">
<meta property="og:title" content="Keras İle Yüz Tanıma">
<meta property="og:url" content="http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/index.html">
<meta property="og:site_name" content="Erhan BARIŞ (Ruslan Asenov)">
<meta property="og:description" content="Artık günümüzde bir çok yapay zeka sorununu python ve zengin kütüphaneleri sayesinde  kolaylıkla çözebiliyoruz. Eskiden oldukça zor ve karmaşık olan çözüm yöntemleri büyük firmaların kullandıkları yap">
<meta property="og:locale" content="tr">
<meta property="og:image" content="http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/yuz_tanima.png">
<meta property="og:updated_time" content="2018-06-10T19:03:43.368Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Keras İle Yüz Tanıma">
<meta name="twitter:description" content="Artık günümüzde bir çok yapay zeka sorununu python ve zengin kütüphaneleri sayesinde  kolaylıkla çözebiliyoruz. Eskiden oldukça zor ve karmaşık olan çözüm yöntemleri büyük firmaların kullandıkları yap">
<meta name="twitter:image" content="http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/yuz_tanima.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Keras İle Yüz Tanıma</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body class="max-width mx-auto px3">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Anasayfa</a></li>
         
          <li><a href="/about-me/">Hakkımda</a></li>
         
          <li><a href="/archives/">Blog</a></li>
         
          <li><a href="/projects/">Projelerim</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/tr/2018/07/26/Yurt-Disinda-Nasil-Is-Bulunur/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/tr/2018/05/27/IPhone-Sniffing-ve-Uygulama-Kandirma/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Önceki yazı</span>
      <span id="i-next" class="info" style="display:none;">Sonraki yazı</span>
      <span id="i-top" class="info" style="display:none;">Yukarı çık</span>
      <span id="i-share" class="info" style="display:none;">Paylaş</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&text=Keras İle Yüz Tanıma"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&is_video=false&description=Keras İle Yüz Tanıma"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Keras İle Yüz Tanıma&body=Check out this article: http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&name=Keras İle Yüz Tanıma&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Keras İle Yüz Tanıma
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Erhan BARIŞ (Ruslan Asenov)</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-06-10T16:40:22.000Z" itemprop="datePublished">10.06.2018</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CNN/">CNN</a>, <a class="tag-link" href="/tags/deep-learning/">deep learning</a>, <a class="tag-link" href="/tags/keras/">keras</a>, <a class="tag-link" href="/tags/yapay-zeka/">yapay zeka</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Artık günümüzde bir çok yapay zeka sorununu python ve zengin kütüphaneleri sayesinde  kolaylıkla çözebiliyoruz. Eskiden oldukça zor ve karmaşık olan çözüm yöntemleri büyük firmaların kullandıkları yapıları açık kaynak kodlu hale getirmeleri ve bir çok gönüllünün bilgi birikimlerini paylaşmaları bu tarz sorunların üstesinden gelmeyi kolaylaştırıyor. Özellikle keras kütüphanesi yeni başlayanlar da dahil olmak üzere bir çok kişi tarafından kullanılıyor. Oldukça kolay ve esnek yapısı sayesinde neredeyse her konuda çözüm üretebiliyor.</p>
<p>Öğrenme amaçlı olarak beni diğer kişilerden ayırt edebilecek ufak bir fikri ile denemeler yapmaya başladım. Öncelikle 1500 tane fotoğrafımı çekip train ettirdikten sonra kamerada beni tanımasını bekledim. Ne yazık ki beklediğim gibi olmadı. Yazdığım kodu değiştirdim, gene olmadı. Nerede hata yaptığımı düşündüm ve sonradan fark ettim ki beni diğer yüzlerden ayırabilmesi için ben ve diğerlerini bilmesi gerekiyor. Biraz tuhaf bir cümle oldu ama aslında tam olarak bu. Yani benim fotoğraflarımı inceleyip beni tanır iken diğer yüzlerden ne farkımın olduğunu anlaması için diğer insanlarıda incelemesi ve benim farklılıklarımı tespit etmesi gerekiyordu. Bende kendi fotoğraflarımın yanında başkalarınında fotoğraflarını çekip train işlemine soktum. Ve beklediğim gibi beni diğer insanlardan ayırt etmeye başladı.<br>Şimdi gelelim bu işlemler nasıl oldu ve nasıl ilerledim.</p>
<p>Öncelikle kameradan görüntü almak gerekiyor. Bir çok kütüphane olsada aralarında en iyisi OpenCV birinci tercihim oldu. Fotoğrafları düzenlemek, işlemek için skimage kullanmayı uygun gördüm. sklearn ile gerekli araç gereçler için kullandım ve tabikide tahmin işlemleri için keras kullandım.</p>
<script src="//gist.github.com/f6846e6a440ac75f3cd0a5024e6e4077.js?file=pip_install"></script>
<p>Gerekli olan bütün eklentileri kurduğumuza göre artık işlemlerimize devam edebiliriz.<br>Elimizde bir dataset yok ve acil olarak bunu oluşturmamız gerekiyor. Bunun içinde anlık olarak kameradan görüntü alıp bunları kullanabiliriz.<br>İnternette OpenCV ile kameradan görüntü almak için bir çok kod var. Benim ki de onlardan çok farklı değil.</p>
<script src="//gist.github.com/f6846e6a440ac75f3cd0a5024e6e4077.js?file=OpenCV_camera.py"></script>
<p>frame bizim fotoğraf değişkenimiz. frame değişkeninin tipi numpy array ve bu bizim bir çok iş yapmaktan kurtaracak. Kameradan aldığımız görüntüleri arka arkaya kayıt ederek dataset oluşturacağız. Bir çok kişiden kayıtlar alıp bunları klasörleyip kullanacağız. Fakat bu fotoğrafların boyutlarının çok büyük olması train işlemini yavaşlatacak ve çıkmaza sokacak bir durum. Tabi elinizde kullanabileceğiniz bir GPU varsa o başka.<br>Fotoğrafları 300 * 300 pixel boyutlarında kullanmayı tercih ediyorum. Kameradan alınan fotoğraflar üzerinde sadece küçültme ve kesme işlemi haricinde bir işlem yapmıyorum.</p>
<script src="//gist.github.com/f6846e6a440ac75f3cd0a5024e6e4077.js?file=OpenCV_camera_2.py"></script>
<p>img klasörünün içerisine <strong>erhan</strong>, <strong>aysel</strong>, <strong>ilker</strong>, <strong>bulent</strong>, <strong>omer</strong> ve <strong>guleser</strong> isimli klasörler açarak kamerada bu kişilerin tek tek fotoğraflarını çekiyoruz. Her enter tuşuna basışımızda bir sonra ki kişinin fotoğrafları çekiliyor. Bunları siz istediğiniz gibi düzenleyin.<br>Böylelikle elimizde tam olarak 7500 tane fotoğraf var ve artık asıl işimize geri dönebiliriz.<br>Öncelikle keras’ta Dense layer kullandım ama istediğim sonuçlara bir türlü ulaşamadım. Zaten görüntü işlemede <strong>CNN</strong> oldukça yaygın olarak kullanılan bir teknik. Nöron ağımızı oluşturmaya ve dataset’imizi train ettirmeye artık başlayabiliriz.</p>
<script src="//gist.github.com/f6846e6a440ac75f3cd0a5024e6e4077.js?file=cnn.py"></script>
<p><strong>Train on 4410 samples, validate on 1890 samples<br>Epoch 1/2<br>2018-06-10 16:02:31.728099: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA<br>4410/4410 [==============================] - 313s 71ms/step - loss: 0.3760 - acc: 0.8565 - val_loss: 0.0137 - val_acc: 0.9958<br>Epoch 2/2<br>4410/4410 [==============================] - 307s 70ms/step - loss: 0.0468 - acc: 0.9850 - val_loss: 0.0108 - val_acc: 0.9958<br>2700/2700 [==============================] - 75s 28ms/step</strong></p>
<p>Test sonuçları oldukça güzel görünüyor.<br><strong>Test Acc : 0.9951851851851852</strong><br><strong>Test Loss : 0.010227037012615863</strong></p>
<p>Kameradan anlık olarak görüntü alıp bunu kontrol ettirebiliriz. Test sonuçları çok iyi olsada gerçekte bu kadar başarılı olamayabiliyor. Üzeride biraz daha çalışılarak daha iyi sonuçlar elde edilebilir fakat şu an için buna gerek yok.<br>Bulmacanın eksik kalan parçalarınıda koyup kodu toparlamanın zamanı geldi.</p>
<script src="//gist.github.com/f6846e6a440ac75f3cd0a5024e6e4077.js?file=final.py"></script>
<p>Üst kısımda yaptıklarımızı biraz daha topladık ve artık çalışan bir kodumuz oldu. Uygulamayı çalıştırdığımızda karenin ortasına kafamızı yerleştirip önce fotoğrafları kayıt ediyoruz sonrasında train işlemi yaplıyor ve bütün bunlar bittikten sonra da kırmızı çizgilerin içerisine kafamızı yerleştirip tahmin etmesini izliyoruz.<br>Bu arada fotoğrafları siyah beyaz olarak kullandığımızı söylemeyi unutmuşm. Zira işleri kısaltmak ve bilgisayarları yormamak istedim.</p>
<p>Ve bu kadar emeğimizin sonucu :)</p>
 
<img src="/tr/2018/06/10/Keras-Ile-Yuz-Tanima/yuz_tanima.png" title="Keras ile yüz tanıma">
  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Anasayfa</a></li>
         
          <li><a href="/about-me/">Hakkımda</a></li>
         
          <li><a href="/archives/">Blog</a></li>
         
          <li><a href="/projects/">Projelerim</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&text=Keras İle Yüz Tanıma"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&is_video=false&description=Keras İle Yüz Tanıma"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Keras İle Yüz Tanıma&body=Check out this article: http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&title=Keras İle Yüz Tanıma"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.erhanbaris.com/tr/2018/06/10/Keras-Ile-Yuz-Tanima/&name=Keras İle Yüz Tanıma&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menü</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Paylaş</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Üst</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Erhan BARIS
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Anasayfa</a></li>
         
          <li><a href="/about-me/">Hakkımda</a></li>
         
          <li><a href="/archives/">Blog</a></li>
         
          <li><a href="/projects/">Projelerim</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
    var host = window.location.hostname;
    if(host != "localhost")
    {
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-110116231-2', 'auto');
        ga('send', 'pageview');
    }
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'erhanbaris-com';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


